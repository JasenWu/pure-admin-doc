(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{681:function(e,t,r){e.exports=r.p+"assets/img/buildgood.bf753b30.jpg"},682:function(e,t,r){e.exports=r.p+"assets/img/no-output.48778faf.jpg"},683:function(e,t,r){e.exports=r.p+"assets/img/output.e13d001d.jpg"},732:function(e,t,r){"use strict";r.r(t);var n=r(22),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("p",[e._v("打包优化关联着网站的稳定与加载速度，在开发中也是非常重要的一项")]),e._v(" "),n("p",[n("img",{attrs:{src:r(681),alt:"serverConfig"}})]),e._v(" "),n("h2",{attrs:{id:"vite-自身的构建优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite-自身的构建优化"}},[e._v("#")]),e._v(" "),n("code",[e._v("vite")]),e._v(" 自身的构建优化")]),e._v(" "),n("p",[e._v("点击查看 "),n("a",{attrs:{href:"https://cn.vitejs.dev/guide/features.html#build-optimizations",target:"_blank",rel:"noopener noreferrer"}},[e._v("build-optimizations"),n("OutboundLink")],1),e._v(" "),n("Badge",{attrs:{text:"vite官方文档"}})],1),e._v(" "),n("h2",{attrs:{id:"css-优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#css-优化"}},[e._v("#")]),e._v(" "),n("code",[e._v("css")]),e._v(" 优化")]),e._v(" "),n("p",[e._v("分两步优化")]),e._v(" "),n("h3",{attrs:{id:"​-压缩-css"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#​-压缩-css"}},[e._v("#")]),e._v(" ​ 压缩 "),n("code",[e._v("css")])]),e._v(" "),n("p",[e._v("使用 "),n("RouterLink",{attrs:{to:"/pages/tailwindcss/#cssnano"}},[e._v("cssnano")]),e._v(" 去压缩 "),n("code",[e._v("css")])],1),e._v(" "),n("h3",{attrs:{id:"​-自动添加浏览器前缀"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#​-自动添加浏览器前缀"}},[e._v("#")]),e._v(" ​ 自动添加浏览器前缀")]),e._v(" "),n("p",[e._v("使用 "),n("RouterLink",{attrs:{to:"/pages/tailwindcss/#autoprefixer"}},[e._v("Autoprefixer")]),e._v(" 自动添加浏览器前缀")],1),e._v(" "),n("h2",{attrs:{id:"组件、工具库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#组件、工具库"}},[e._v("#")]),e._v(" 组件、工具库")]),e._v(" "),n("ul",[n("li",[n("p",[e._v("无论是组件（如 "),n("code",[e._v("element-plus")]),e._v("、"),n("code",[e._v("vxe-table")]),e._v("），还是工具库（如 "),n("code",[e._v("lodash")]),e._v("、"),n("code",[e._v("axios")]),e._v("）我们都应该尽可能的按需引入，使其有良好的  "),n("code",[e._v("tree-shaking")]),e._v(" 效果，这样项目整体打包出来的无用代码就少之又少了")])]),e._v(" "),n("li",[n("p",[e._v("拿 "),n("code",[e._v("lodash")]),e._v(" 举例，"),n("code",[e._v("lodash")]),e._v(" 默认是 "),n("code",[e._v("cjs")]),e._v(" 格式，不支持 "),n("code",[e._v("es6")]),e._v(" 的 "),n("code",[e._v("import")]),e._v(" 语法，那么我们就可以去 "),n("code",[e._v("github")]),e._v(" 或者某些搜索引擎去寻找替代品，最终平台找到了 "),n("code",[e._v("lodash-unified")]),e._v("，它完全兼容 "),n("code",[e._v("lodash")]),e._v(" 的全部语法并且既支持 "),n("code",[e._v("esm")]),e._v(" 又支持 "),n("code",[e._v("cjs")]),e._v("，这使得它无论在浏览器还是 "),n("code",[e._v("node")]),e._v(" 环境中表现都很良好。当然如果遇到那种只支持 "),n("code",[e._v("cjs")]),e._v(" 格式，网上找遍了都找不到兼容 "),n("code",[e._v("esm")]),e._v(" 格式的咋办呢，这时你可以参考 "),n("code",[e._v("lodash-unified")]),e._v("，看看别人是如何转换的 😊")])]),e._v(" "),n("li",[n("p",[e._v("平台精简版首次启动时间我这边测试是 "),n("code",[e._v("7")]),e._v(" 秒，刷新页面的话也就 "),n("code",[e._v("1-2")]),e._v(" 秒，可看下面的视频。如果您使用 "),n("code",[e._v("pure-admin")]),e._v(" 且当前网页"),n("code",[e._v("首启动")]),e._v("和"),n("code",[e._v("刷新页面")]),e._v("的等待时间远远大于前面的数字，也该考虑优化了。当项目具有一定规模的时候，优化并没有那么容易，所以您在写代码前就应该遵循我上面的说法，按需引入才是 "),n("code",[e._v("yyds")]),e._v(" 😄\n"),n("video",{attrs:{width:"320",height:"240",controls:""}},[n("source",{attrs:{src:e.$withBase("/video/start.mov"),type:"video/mp4"}})])])]),e._v(" "),n("li",[n("p",[n("code",[e._v("vite")]),e._v(" 目前最大的性能瓶颈是大量模块的首页加载，可看 "),n("a",{attrs:{href:"https://github.com/vitejs/vite/issues/1309#issue-777569758",target:"_blank",rel:"noopener noreferrer"}},[e._v("vite-issues"),n("OutboundLink")],1),e._v("，值得期待的是这个 "),n("a",{attrs:{href:"https://github.com/vitejs/vite/pull/10671",target:"_blank",rel:"noopener noreferrer"}},[e._v("pr"),n("OutboundLink")],1),e._v(" 可能会缓解这个麻烦")])])]),e._v(" "),n("h2",{attrs:{id:"压缩-gzip、brotli-格式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#压缩-gzip、brotli-格式"}},[e._v("#")]),e._v(" 压缩 "),n("code",[e._v("gzip")]),e._v("、"),n("code",[e._v("brotli")]),e._v(" 格式")]),e._v(" "),n("p",[e._v("使用 "),n("a",{attrs:{href:"https://github.com/vbenjs/vite-plugin-compression",target:"_blank",rel:"noopener noreferrer"}},[e._v("vite-plugin-compression"),n("OutboundLink")],1),e._v(" 对项目进行 "),n("code",[e._v("gzip")]),e._v(" 或者 "),n("code",[e._v("brotli")]),e._v(" 压缩，"),n("code",[e._v("nginx")]),e._v(" 对这两种压缩模式都支持，压缩后部署到 "),n("code",[e._v("nginx")]),e._v(" 将极大提高网页加载速度")]),e._v(" "),n("h3",{attrs:{id:"如何开启压缩"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#如何开启压缩"}},[e._v("#")]),e._v(" 如何开启压缩")]),e._v(" "),n("p",[e._v("来到 "),n("code",[e._v(".env.production")]),e._v(" 文件，设置 "),n("a",{attrs:{href:"https://gitee.com/yiming_chang/pure-admin-thin/blob/main/.env.production#L19",target:"_blank",rel:"noopener noreferrer"}},[e._v("VITE_COMPRESSION"),n("OutboundLink")],1),e._v(" 即可。设置总体分为下面两种 "),n("a",{attrs:{href:"https://gitee.com/yiming_chang/pure-admin-thin/blob/main/build/compress.ts",target:"_blank",rel:"noopener noreferrer"}},[e._v("具体实现代码"),n("OutboundLink")],1)]),e._v(" "),n("h4",{attrs:{id:"两种总体设置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#两种总体设置"}},[e._v("#")]),e._v(" 两种总体设置")]),e._v(" "),n("ol",[n("li",[e._v("压缩时不删除原始文件的配置")]),e._v(" "),n("li",[e._v("压缩时删除原始文件的配置")])]),e._v(" "),n("h5",{attrs:{id:"压缩时不删除原始文件的配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#压缩时不删除原始文件的配置"}},[e._v("#")]),e._v(" 压缩时不删除原始文件的配置")]),e._v(" "),n("div",{staticClass:"language-.env.production line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('开启 gzip 压缩\nVITE_COMPRESSION = "gzip"\n\n开启 brotli 压缩\nVITE_COMPRESSION = "brotli"\n\n# 同时开启 gzip 与 brotli 压缩\nVITE_COMPRESSION = "both"\n\n# 不开启压缩，默认\nVITE_COMPRESSION = "none"\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br")])]),n("h5",{attrs:{id:"压缩时删除原始文件的配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#压缩时删除原始文件的配置"}},[e._v("#")]),e._v(" 压缩时删除原始文件的配置")]),e._v(" "),n("div",{staticClass:"language-.env.production line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('开启 gzip 压缩\nVITE_COMPRESSION = "gzip-clear"\n\n开启 brotli 压缩\nVITE_COMPRESSION = "brotli-clear"\n\n# 同时开启 gzip 与 brotli 压缩\nVITE_COMPRESSION = "both-clear"\n\n# 不开启压缩，默认\nVITE_COMPRESSION = "none"\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br")])]),n("h2",{attrs:{id:"采用-cdn-模式替换本地依赖"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#采用-cdn-模式替换本地依赖"}},[e._v("#")]),e._v(" 采用 "),n("code",[e._v("cdn")]),e._v(" 模式替换本地依赖")]),e._v(" "),n("h3",{attrs:{id:"vite-插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vite-插件"}},[e._v("#")]),e._v(" "),n("code",[e._v("vite")]),e._v(" 插件")]),e._v(" "),n("p",[e._v("使用 "),n("a",{attrs:{href:"https://github.com/MMF-FE/vite-plugin-cdn-import/blob/master/README.zh-CN.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("vite-plugin-cdn-import"),n("OutboundLink")],1),e._v(" 插件，在打包时将指定的 "),n("code",[e._v("modules")]),e._v(" 替换成 "),n("code",[e._v("cdn")]),e._v(" 链接，从而减少构建时间，提高生产环境中页面加载速度。")]),e._v(" "),n("h3",{attrs:{id:"cdn-厂商-免费"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cdn-厂商-免费"}},[e._v("#")]),e._v(" "),n("code",[e._v("cdn")]),e._v(" 厂商（免费）")]),e._v(" "),n("p",[e._v("平台 "),n("code",[e._v("cdn")]),e._v(" 采用的是国内 "),n("a",{attrs:{href:"https://www.bootcdn.cn",target:"_blank",rel:"noopener noreferrer"}},[e._v("bootcdn"),n("OutboundLink")],1),e._v("，主要是稳定并且快，当然您也可以选择 "),n("a",{attrs:{href:"https://unpkg.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("unpkg"),n("OutboundLink")],1),e._v(" 或者 "),n("a",{attrs:{href:"https://www.jsdelivr.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("jsdelivr"),n("OutboundLink")],1),e._v("，这两个 "),n("code",[e._v("cdn")]),e._v(" 是国外的")]),e._v(" "),n("h3",{attrs:{id:"如何启动-cdn-替换"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#如何启动-cdn-替换"}},[e._v("#")]),e._v(" 如何启动 "),n("code",[e._v("cdn")]),e._v(" 替换")]),e._v(" "),n("p",[e._v("来到 "),n("code",[e._v(".env.production")]),e._v(" 文件，将 "),n("a",{attrs:{href:"https://gitee.com/yiming_chang/pure-admin-thin/blob/main/.env.production#L14",target:"_blank",rel:"noopener noreferrer"}},[e._v("VITE_CDN"),n("OutboundLink")],1),e._v(" 设置成 "),n("code",[e._v("true")]),e._v(" 即可")]),e._v(" "),n("h3",{attrs:{id:"默认启动-cdn-替换的模块有哪些"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#默认启动-cdn-替换的模块有哪些"}},[e._v("#")]),e._v(" 默认启动 "),n("code",[e._v("cdn")]),e._v(" 替换的模块有哪些")]),e._v(" "),n("p",[n("code",[e._v("vue")]),e._v("、"),n("code",[e._v("vue-router")]),e._v("、"),n("code",[e._v("vue-demi")]),e._v("、"),n("code",[e._v("pinia")]),e._v("、"),n("code",[e._v("element-plus")]),e._v("、"),n("code",[e._v("axios")]),e._v("、"),n("code",[e._v("dayjs")]),e._v("、"),n("code",[e._v("echarts")]),e._v("、"),n("code",[e._v("lodash")]),e._v("，具体代码 "),n("a",{attrs:{href:"https://gitee.com/yiming_chang/pure-admin-thin/blob/main/build/cdn.ts",target:"_blank",rel:"noopener noreferrer"}},[e._v("build/cdn.ts"),n("OutboundLink")],1)]),e._v(" "),n("h2",{attrs:{id:"生产环境删除-console-log"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#生产环境删除-console-log"}},[e._v("#")]),e._v(" 生产环境删除 "),n("code",[e._v("console.log")])]),e._v(" "),n("p",[e._v("使用平台开发的 "),n("a",{attrs:{href:"https://github.com/xiaoxian521/vite-plugin-remove-console",target:"_blank",rel:"noopener noreferrer"}},[e._v("vite-plugin-remove-console"),n("OutboundLink")],1),e._v(" 插件，在打包构建时移除项目中所有的 "),n("code",[e._v("console.log")])]),e._v(" "),n("h2",{attrs:{id:"提供传统浏览器兼容性支持"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#提供传统浏览器兼容性支持"}},[e._v("#")]),e._v(" 提供传统浏览器兼容性支持")]),e._v(" "),n("p",[e._v("使用 "),n("code",[e._v("vite")]),e._v(" 推荐的 "),n("a",{attrs:{href:"https://cn.vitejs.dev/plugins/#vitejsplugin-legacy",target:"_blank",rel:"noopener noreferrer"}},[e._v("@vitejs/plugin-legacy"),n("OutboundLink")],1),e._v(" 插件，在打包构建前，只需来到 "),n("code",[e._v(".env.production")]),e._v(" 文件，将 "),n("a",{attrs:{href:"https://gitee.com/yiming_chang/pure-admin-thin/blob/main/.env.production#L11",target:"_blank",rel:"noopener noreferrer"}},[e._v("VITE_LEGACY"),n("OutboundLink")],1),e._v(" 设置成 "),n("code",[e._v("true")]),e._v(" 即可打包出兼容低版本浏览器和 "),n("code",[e._v("IE11")]),e._v(" 版本的代码")]),e._v(" "),n("h2",{attrs:{id:"静态资源分类打包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#静态资源分类打包"}},[e._v("#")]),e._v(" 静态资源分类打包")]),e._v(" "),n("p",[n("code",[e._v("vite")]),e._v(" 是基于 "),n("code",[e._v("esbuild")]),e._v(" 和 "),n("code",[e._v("rollup")]),e._v("构建的，在打包时如果不进行 "),n("code",[e._v("output")]),e._v(" 的配置，打包出来的效果如下图（这也是 "),n("code",[e._v("vite")]),e._v(" 默认打包出来的效果，可以看到所有文件都混在一起）")]),e._v(" "),n("p",[n("img",{attrs:{src:r(682),alt:"no-output"}})]),e._v(" "),n("p",[e._v("下图是我们配置 "),n("a",{attrs:{href:"https://gitee.com/yiming_chang/pure-admin-thin/blob/main/vite.config.ts#L73-83",target:"_blank",rel:"noopener noreferrer"}},[e._v("output"),n("OutboundLink")],1),e._v(" 后的效果，可以看到文件都进行了分类存放，这也方便我们查找文件")]),e._v(" "),n("p",[n("img",{attrs:{src:r(683),alt:"output"}})])])}),[],!1,null,null,null);t.default=s.exports}}]);